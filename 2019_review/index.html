<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.0.0" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<meta name="google-site-verification" content="5JWyXG4mx6i5avE6xJfXIRHu_YCofrhDQRCEgbm_5ak" />
<title>2019 回顧工作與學習歷程 - WadeHuang1993&#39;s Blog</title>


    <meta name="description" content="2019 回顧前言2019 年可以說是既充實又偷懶的一年。為什麼呢？因為花了很多時間在學習理論知識，包含：重構、整潔架構、單元測試、領域驅動開發、行為驅動開發 …等等。雖然每個知識看起來像是完全獨立的領域，但對 2019 的我來說，它們都是應付 Legacy Application 的利器。 為什麼又說偷懶？部落格和作品幾乎停擺！學習知識理論不像學習新技術，能把應用新技術的步驟分享到部落格上。因為">
<meta name="keywords" content="PHP, OOP, JavaScript, Web development">
<meta property="og:type" content="article">
<meta property="og:title" content="2019 回顧工作與學習歷程">
<meta property="og:url" content="https:&#x2F;&#x2F;wadehuang1993.github.io&#x2F;blog&#x2F;2019_review&#x2F;index.html">
<meta property="og:site_name" content="WadeHuang1993&#39;s Blog">
<meta property="og:description" content="2019 回顧前言2019 年可以說是既充實又偷懶的一年。為什麼呢？因為花了很多時間在學習理論知識，包含：重構、整潔架構、單元測試、領域驅動開發、行為驅動開發 …等等。雖然每個知識看起來像是完全獨立的領域，但對 2019 的我來說，它們都是應付 Legacy Application 的利器。 為什麼又說偷懶？部落格和作品幾乎停擺！學習知識理論不像學習新技術，能把應用新技術的步驟分享到部落格上。因為">
<meta property="og:locale" content="zh-TW">
<meta property="og:image" content="https:&#x2F;&#x2F;wadehuang1993.github.io&#x2F;blog&#x2F;blog&#x2F;images&#x2F;thumbnail&#x2F;2019_reviews.png">
<meta property="og:updated_time" content="2019-12-26T09:24:13.215Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;wadehuang1993.github.io&#x2F;blog&#x2F;blog&#x2F;images&#x2F;thumbnail&#x2F;2019_reviews.png">







<link rel="icon" href="/blog/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/blog/css/back-to-top.css">

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-154595924-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-154595924-1');
</script>

    
    
    
    
    
    <link rel="stylesheet" href="/blog/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    
    


<link rel="stylesheet" href="/blog/css/style.css">

</head>
<!-- <body class="is-2-column"> -->
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/blog/">
            
                <img src="/blog/images/mylogo.png" alt="2019 回顧工作與學習歷程" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item"
                href="/blog/">首頁</a>
                
                <a class="navbar-item"
                href="/blog/archives">文章時間軸</a>
                
                <a class="navbar-item"
                href="/blog/categories">分類檢索</a>
                
                <a class="navbar-item"
                href="/blog/tags">標籤</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="文章目錄" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="搜尋" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main">
<div class="card">
    
    <div class="card-image">
        <span  class="image is-7by1">
            <img class="thumbnail" src="/blog/images/thumbnail/2019_reviews.png" alt="2019 回顧工作與學習歷程">
        </span>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-12-19T06:48:16.000Z">2019-12-19</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    1 小時 閱讀文 (大約 8323 個字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                2019 回顧工作與學習歷程
            
        </h1>
        <div class="content">
            <h1 id="2019-回顧前言"><a href="#2019-回顧前言" class="headerlink" title="2019 回顧前言"></a>2019 回顧前言</h1><p>2019 年可以說是既充實又偷懶的一年。為什麼呢？因為花了很多時間在學習理論知識，包含：重構、整潔架構、單元測試、領域驅動開發、行為驅動開發 …等等。雖然每個知識看起來像是完全獨立的領域，但對 2019 的我來說，它們都是應付 Legacy Application 的利器。</p>
<p>為什麼又說偷懶？部落格和作品幾乎停擺！學習知識理論不像學習新技術，能把應用新技術的步驟分享到部落格上。因為理論知識必須經過堆疊和內化才能在真實專案中落地實踐。再加上這一年很<strong>榮幸受邀到高雄科技大學，帶領一批資工系的學生學習 PHP 式設計課程</strong>，備課與上課的時間幾乎吃掉了三個月的休閒時間，也就是平常能用來自學或練習的時間 …<a id="more"></a>。</p>
<p>至於工作呢？這份工作是我搬來高雄的第一份工作，工作內容主要是維護一個大型的 Legacy Application。雖然說是維護，但仍不斷有新需求一直進來。這也是為什麼我必須花費很多時間閱讀如何處理 Legacy Application 的相關書籍和技術。很慶幸我也有機會將學到的知識導入專案中，增加部分功能的彈性；或是阻止部分功能繼續腐敗。改善程式碼品質的成就感讓我更多的動力繼續學習。</p>
<p>可惜 2019 對我來說是一眨眼就結束，到年尾了還來不及紀錄下學習與實踐的東西。所以想先以流水帳的形式紀錄一下 2019 年所學的知識和工作中實踐的技術。</p>
<hr>
<p>　　</p>
<h1 id="自學主題"><a href="#自學主題" class="headerlink" title="自學主題"></a>自學主題</h1><h2 id="DDD《領域驅動設計》"><a href="#DDD《領域驅動設計》" class="headerlink" title="DDD《領域驅動設計》"></a>DDD《領域驅動設計》</h2><p>在 1 月準備系統重構流程的過程中，覺得自己對於「領域模型」不夠瞭解，因此決定拜讀一下《領域驅動設計》，增進自己對領域模型的認知。</p>
<p>DDD 是一個開發論，涵蓋的領域很多，可以說是納入各個程式設計層次的最佳實踐，包含：設計模式、DDD 四層架構（戰術設計）到多個系統間如何劃分邊界（戰略設計）。也因為 DDD 以多種層次來探討程式應該如何「設計」，讓我的思維直接上升好幾個層次，看待程式碼的視角變得更廣、更高階。</p>
<p><img src="/blog/images/pasted-18.png?600px" alt="DDD 四層架構，透過隔離每一層讓程式碼可以適應變化"></p>
<p>DDD 可以說是繼 SOLID 原則後影響我很深的知識，以前的思維只停留在物件與物件之間， DDD 讓我見識到系統架構如何應用「良好的程式設計」來應對變化，引起了我對系統架構的興趣。不過 DDD 對當時的我來說仍然有很多看不懂的部分（尤其是戰略設計），目前規劃 2020 年會再回來鑽研一次！</p>
<hr>
<p>　　
　　</p>
<h2 id="《Clean-Architecture》"><a href="#《Clean-Architecture》" class="headerlink" title="《Clean Architecture》"></a>《Clean Architecture》</h2><p>《<a href="https://www.tenlong.com.tw/products/9789864342945" target="_blank" rel="noopener">Clean Architecture</a>》本來並不在 2019 的書單裡面，但是在學習 DDD 的過程中發現不斷有人拿 Clean Architecture 的架構來跟 DDDLite 架構做比較，這才引起我對 Clean Architecture 的興趣。</p>
<p>很幸運地，這又是一本可以讓程式設計思維提升好幾個層次的好書！Clean Architecture 可以說是物件導向設計 SOLID 原則的延伸，如果說 SOLID 是指導開發人員如何設計物件，那麼 Clean Architecture 就是指導開發人員如何將多個物件組織起來，並且用一套清晰易懂的規則讓物件與物件彼此協作，完成系統需求所需的功能。</p>
<p><img src="/blog/images/pasted-20.png?500x" alt="Clean-Architecture-graph"></p>
<p>整潔架構中，依照程式的重要程度來劃分層級：</p>
<blockquote>
<p>越核心的邏輯越往內圈靠，容易變化的附加邏輯則越往外層靠。</p>
</blockquote>
<p>越內圈的邏輯層次就越高（層次高表示彈性高），最內圈屬於業務規則的<strong>核心策略</strong>；外圈則是圍繞著核心業務規則並隨著需求不斷變化的 <strong>機制</strong>。這樣劃分的原因是，系統必須保持核心業務邏輯的彈性來因應多變的需求。內圈的程式碼彈為了保持彈性，也會引入較多的抽象；外圈的程式碼則是按需求所需，透過實作內圈公開的抽象來存取或擴充核心業務規則，以完成需求所需的功能。</p>
<p>除了分層以外，還需要遵循「相依性規則」：</p>
<blockquote>
<p>原始碼依賴關係只能指向內部，朝向更高層級的策略。</p>
</blockquote>
<p>這裏指的是，<strong>內圈不能知道外圈的存在</strong>。包含外圈的變數、類別、函式。只要在內圈看到 <code>import</code> 或是 <code>using</code> 引入外圈的東西就代表違反了規定。這樣的好處是可以將 <strong>策略</strong> 與 <strong>機制</strong> 隔離開來。身為一個開發人員必須意識到，將 <strong>策略</strong> 和 <strong>機制</strong> 寫在一起是很致命的錯誤！因為 <strong>機制</strong>（如 UI 介面）的需求變動頻率很大，而且有很大的機率修改到 <strong>策略</strong>（核心業務邏輯）的程式碼。為了避免 <strong>策略</strong> 被影響，應該隔離 <strong>策略</strong> 與 <strong>機制</strong>，這麼一來被隔離開的程式碼會以不同的速率和原因被修改，並且不會影響到彼此的程式碼。</p>
<p>另外，Clean Architecture 架構的同心圓並不一定要是 4 圈，4 圈只是作者為了方便講解層次而已。</p>
<blockquote>
<p>最重要的是要做到「隔離策略與機制」和「遵循相依性規則」!</p>
</blockquote>
<h3 id="開發人員必須防止程式碼腐敗"><a href="#開發人員必須防止程式碼腐敗" class="headerlink" title="開發人員必須防止程式碼腐敗"></a>開發人員必須防止程式碼腐敗</h3><p>手頭上的 Legacy Application 到處都可以看見“參數很多且內容包含大量 if 或 switch 的大函式”，例如：</p>
<figure class="highlight php hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudentModel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span></span></span><br><span class="line"><span class="hljs-class"></span>&#123;</span><br><span class="line">    <span class="hljs-keyword">private</span> $db;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/** 取得學生列表 */</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">studentList</span><span class="hljs-params">($classId, $homeworkId = null, $bicyclePassYear = null, <span class="hljs-comment">/** ... 省略 */</span>)</span></span></span><br><span class="line"><span class="hljs-function">    </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;db-&gt;select(<span class="hljs-string">'*'</span>);</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;db-&gt;join(<span class="hljs-string">'homeworks'</span>, <span class="hljs-string">'students.id = homeworks.studentId'</span>);</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;db-&gt;leftJoin(<span class="hljs-string">'bicyclePass'</span>, <span class="hljs-string">'students.id = bicyclePass.studentId'</span>);</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;db-&gt;from(<span class="hljs-string">'students'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">// 回家作業繳交狀況列表</span></span><br><span class="line">        <span class="hljs-keyword">if</span> ($homeworkId != <span class="hljs-keyword">null</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;where(<span class="hljs-string">'homework.id'</span>, $homeworkId);</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;where(<span class="hljs-string">'homeworks.status'</span>, <span class="hljs-string">'done'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="hljs-comment">// 腳踏車證繳費記錄列表</span></span><br><span class="line">        <span class="hljs-keyword">if</span> ($bicyclePassYear != <span class="hljs-keyword">null</span>) &#123;</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;db-&gt;where(<span class="hljs-string">'bicyclePass.year'</span>, $bicyclePassYear);</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;db-&gt;where(<span class="hljs-string">'bicyclePass.payStatus'</span>, <span class="hljs-keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="hljs-comment">/** ...省略 */</span></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;db-&gt;where(<span class="hljs-string">'students.classId'</span>, $classId);</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;db-&gt;get()-&gt;resultArray();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>StudentModel-&gt;studentList()</code> 是一個正在腐敗的程式碼，因為它的 <strong>策略</strong> 與 <strong>機制</strong> 被寫在一起了。這種安排程式的方式往往會在遇到新需求時，就替函式新增幾個參數或 if 來完成新需求的功能。雖然這個案例看起來很小又不複雜，但是，<strong>如果開發人員不懂得將策略與機制隔離，不用一下子專案中就會充滿又臭又長的大函式</strong>！而且這些大函式常常又是 <strong>策略</strong> 與 <strong>機制</strong> 完全攪在一起，開發人員根本難以辨認函式最原始的邏輯是什麼！</p>
<h3 id="隔離策略與機制，防止程式碼腐敗"><a href="#隔離策略與機制，防止程式碼腐敗" class="headerlink" title="隔離策略與機制，防止程式碼腐敗"></a>隔離策略與機制，防止程式碼腐敗</h3><p>在我維護的專案中，有一個核心功能為「簽核公文」。使用者需要有一個「簽核歷史紀錄」的畫面來追蹤公文狀態：</p>
<p><img src="/blog/images/pasted-21.png?700x" alt="顯示簽核紀錄功能"></p>
<p>「簽核歷史紀錄」功能的資料是經由 Workflow 類別的 <code>process()</code> 函式撈取的：</p>
<figure class="highlight php hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Workflow</span></span></span><br><span class="line"><span class="hljs-class"></span>&#123;</span><br><span class="line">    <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> array 所有簽核 */</span></span><br><span class="line">    <span class="hljs-keyword">protected</span> $process = <span class="hljs-keyword">array</span>();</span><br><span class="line">    <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> Workflow_repository 資料庫操作層 */</span></span><br><span class="line">    <span class="hljs-keyword">private</span> $repo;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 取得 所有簽核資料</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> array</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;repo-&gt;get_process(<span class="hljs-keyword">$this</span>-&gt;workflow_id)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="hljs-comment">// ... 省略</span></span><br></pre></td></tr></table></figure>

<p>但是目前 <code>Workflow-&gt;process()</code> 只有撈取「簽核資料」是不夠的，因為客戶要求「簽核歷史紀錄」畫面需要更多的資訊：</p>
<ol>
<li>隱藏匿名簽核成員的名稱</li>
<li>異常的流程須標記成紅色</li>
<li>顯示異常流程的原因</li>
</ol>
<p>到目前為止可以看到，「簽核歷史紀錄」是屬於與 UI 相關的新需求。在 Clean Architecture 架構的同心圓中，UI 被分類在外圈，也就是 <strong>機制</strong>。Workflow 類別則是系統的核心功能，故屬於同心圓的內圈，也就是 <strong>策略</strong>。</p>
<p>如果開發人員直接擴充 <code>Workflow-&gt;process()</code> 的程式碼來完成「簽核歷史紀錄」的功能，等同於“把機制的程式碼寫進策略中”，不但使程式碼變得不易維護，還讓系統中其他調用 <code>Workflow-&gt;process()</code> 的功能都被迫執行「簽核歷史紀錄」的程式碼！</p>
<p>因此應該遵循 Clean Architecture 的「隔離策略與機制」原則，我們必須隔離 <code>Workflow-&gt;process()</code> 與「簽核歷史紀錄」的程式碼。做法很簡單，只需要讓 <code>Workflow</code> 引入一個抽象介面，讓外部可以注入 <strong>機制</strong> 的程式碼，就是做到隔離 <strong>機制</strong> 和 <strong>策略</strong>：</p>
<figure class="highlight php hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * Interface Decorator</span></span><br><span class="line"><span class="hljs-comment"> *</span></span><br><span class="line"><span class="hljs-comment"> * 用於擴充領域模型撈取資料邏輯 for UI 介面</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Decorator</span> </span>&#123;</span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 擴充領域模型的資料</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * 先利用領域模型取得資料，</span></span><br><span class="line"><span class="hljs-comment">     * 再取得 UI 層的所需資料</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> $domain_object</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> mixed</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decorator</span><span class="hljs-params">($domain_object)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Workflow</span></span></span><br><span class="line"><span class="hljs-class"></span>&#123;</span><br><span class="line">    <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> Decorator[] 資料裝飾器 */</span></span><br><span class="line">    <span class="hljs-keyword">private</span> $decorators = [];</span><br><span class="line">    <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> array 所有簽核 */</span></span><br><span class="line">    <span class="hljs-keyword">protected</span> $process = <span class="hljs-keyword">array</span>();</span><br><span class="line">    <span class="hljs-comment">/** <span class="hljs-doctag">@var</span> Workflow_repository 資料庫操作層 */</span></span><br><span class="line">    <span class="hljs-keyword">private</span> $repo;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 引入資料裝飾器，讓資料可以隨著需求擴充</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> Decorator $decorator 資料裝飾器</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add_decorator</span><span class="hljs-params">(Decorator $decorator)</span></span></span><br><span class="line"><span class="hljs-function">    </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;decorators[] = $decorator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 取得 簽核流程</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> array</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function">    </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;process = <span class="hljs-keyword">$this</span>-&gt;repo-&gt;get_process(<span class="hljs-keyword">$this</span>-&gt;workflow_id);</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">// 如果有配置裝飾器，則執行裝飾器擴充資料邏輯</span></span><br><span class="line">        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;decorators <span class="hljs-keyword">as</span> $decorator) &#123;</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;process = $decorator-&gt;decorator(<span class="hljs-keyword">$this</span>-&gt;process);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;process;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>上面這段範例程式碼，已經完全將策略和機制隔離了：</p>
<ol>
<li>新增了一個用來擴充資料的抽象介面 <code>Decorator</code></li>
<li>在 <code>Workflow</code> 新增一個公開的 <code>add_decorator()</code> 函式，提供外部將實作 <code>Decorator</code> 抽象介面的實體物件注入 <code>Workflow</code>。</li>
<li>調整 <code>Workflow-&gt;process()</code> 函式，調用被注入的 <code>Decorator</code> 實體物件來擴充資料。</li>
</ol>
<p>這一個步驟的核心觀念是 <strong>策略必須開放擴充點，讓機制從外部擴充策略的邏輯</strong>，只有這麼做才能讓策略應對千變萬化的需求。</p>
<p>開放擴充點後，只需要依照「簽核歷史紀錄」的需求，並新增 <code>實作 Decorator 的類別</code> 來擴充 <code>Workflow</code> 的邏輯就好了：</p>
<p><img src="/blog/images/pasted-22.png" alt="由 Controller 注入 UI 所需的機制，擴充策略的邏輯"></p>
<p>從上圖可以發現，<code>Workflow</code> 只能透過抽象介面來使用 <strong>機制</strong>，換句話說 <code>Workflow</code> 根本不知道 <code>Hide_anonymous_user_name.php</code> 和 <code>Mark_error_process.php</code> 的存在！這正是「相依性規則」所謂的“<strong>內圈不能知道外圈的存在</strong>”。抽象介面就像一道邊界，隔離了策略與機制。而邊界的兩邊將以不同的速率和原因被改變。</p>
<h3 id="一直都是開放封閉原則"><a href="#一直都是開放封閉原則" class="headerlink" title="一直都是開放封閉原則"></a>一直都是開放封閉原則</h3><p><img src="/blog/images/pasted-8.png?400x" alt="策略與機制只能透過抽象介面存取彼此"></p>
<p>較有經驗的開發人員應該會發現這不正是 <strong>開放封閉原則</strong> 嗎？沒錯，Uncle bob 在書中也說了：</p>
<blockquote>
<p>事實上，軟體開發技術的歷史就是「如何方便地建立 Plugin 來奠定可擴展和可維護的系統架構」的故事 -《Clean Architecture》</p>
</blockquote>
<p>《Clean Architecture》一書揭露了軟體開發從設計物件到組織架構，其實都是應用「隔離策略與機制」的思維來控制軟體複雜度，至於如何做到隔w離策略和機制則是按照不同的情境有不同的作法。</p>
<hr>
<p>　　</p>
<h1 id="工作實踐經驗"><a href="#工作實踐經驗" class="headerlink" title="工作實踐經驗"></a>工作實踐經驗</h1><h2 id="替專案導入-Commit-Message-規範"><a href="#替專案導入-Commit-Message-規範" class="headerlink" title="替專案導入 Commit Message 規範"></a>替專案導入 Commit Message 規範</h2><p>打開新公司的程式碼，發現這裡的開發人員沒有統一撰寫 Git Commit Message 的格式，這對一個長期維護的系統來說並不是一件好事！打開 Git History 幾乎找不出;對程式碼異動的意圖與原因，往往只有原作者知道自己的程式碼在做什麼…。</p>
<p>為了解決這個問題，我向眾開發人員提議可以導入 Commit Message 規範，規範的詳細內容已經被記錄在「<a href="http://localhost:4000/blog/git_commit_message_best_practice/" target="_blank" rel="noopener">Git Commit Message 這樣寫會更好，替專案引入規範與範例
</a>」 文章中。</p>
<h3 id="實際案例"><a href="#實際案例" class="headerlink" title="實際案例"></a>實際案例</h3><p><strong>1. 同仁導入規範前的 Commit Message：</strong><br><img src="/blog/images/pasted-16.png" alt></p>
<p><strong>2. 導入規範後，開始會紀錄異動原因與內容：</strong><br><img src="/blog/images/pasted-17.png" alt></p>
<p>雖然過了好幾個月才讓大部分的開發人員確實按規範撰寫 Commit Message，但是<strong>開發團隊中已經養成一個優良的文化！當良好 Commit Message 持續被 Commit 進程式庫，新進人員將自然而然地遵循前人的格式撰寫 Commit Message</strong>。</p>
<hr>
<p>　　</p>
<h2 id="替專案導入單元測試"><a href="#替專案導入單元測試" class="headerlink" title="替專案導入單元測試"></a>替專案導入單元測試</h2><p>時間拉回到剛搬到高雄的 2018 末。當時我才剛學會重構和單元測試。面試時，公司的技術顧問說公司想要導入單元測試和重構，希望我一定要進公司幫忙。我也答應了！真的很感謝有這個機會可以實踐導入重構與單元測試（讓我成長很多）。</p>
<p>這間公司的專案使用 CodeIgniter 3 框架（後面簡稱 CI3)，CI3 本身並不是倡導物件導向開發風格的框架，專案的程式碼自然而然也是偏向義大利麵風格。加上專案是維護多年的大系統，在這樣的環境下導入單元測試變得很困難！  </p>
<p>雖然說導入單元測試很困難，但說真的，除非專案使用物件導向風格開發以及有持續重構的習慣，不然不可能輕易導入單元測試吧！而且從身邊碼農朋友的經驗看來，幾乎 100% 的專案沒辦法輕易導入單元測試。所以我<strong>把這次的困難當作挑戰，練習如何讓單元測試在一個 Legacy Application 落地</strong>。</p>
<h3 id="建立測試框架"><a href="#建立測試框架" class="headerlink" title="建立測試框架"></a>建立測試框架</h3><p>由於 CI3 架構內建的單元測試功能很少，所以我選用整合了 PHPUnit 的 <a href="https://github.com/kenjis/ci-phpunit-test" target="_blank" rel="noopener">ci-phpunit-test</a> 來當作專案的測試框架。建立測試框架其實是導入單元測試最快最簡單的步驟，因為其他開發人員並不懂單元測試的相關知識，所以一定要盡可能地簡化撰寫單元測試的複雜度，才能讓單元測試“較有機會”導入開發團隊…</p>
<h3 id="隔離測試環境對-DB-的副作用"><a href="#隔離測試環境對-DB-的副作用" class="headerlink" title="隔離測試環境對 DB 的副作用"></a>隔離測試環境對 DB 的副作用</h3><p>為了避免測試環境的行為污染 DB 的資料，因此要隔離單元測試與 DB。當時第一個想法是：”在測試環境下一律使用 SQLite”，因為 SQLite 可開啟 In Memory 模式，在記憶體中操作資料庫。當程式關閉後，記憶體內的 SQLite 資料庫也會清空，相當適合測試環境使用（無副作用）。</p>
<p>做法很簡單，只要把 MySQL 的備份檔案轉成 SQLite，再到 CI3 的設定檔案中將測試環境的 DB 驅動器改成 SQLite 就可以了…。  </p>
<p>但是實際運作起來，總有一些功能會發生錯誤。原本以為是 MySQL 的資料在轉換成 SQLite 的過程中有失真。經過百般測試後發現，原來是專案很多功能是用手寫的字串來組織 SQL 指令，而不是透過 CI3 的 QueryBuilder 來建立 SQL 指令。手寫的 MySQL 指令讓測試環境中的 SQLite 驅動器編譯失敗。我也因此學到一個教訓：</p>
<blockquote>
<p>專案應該盡可能用 QueryBuilder 或 ORM 等資料庫操作層來編寫 SQL，否則專案要切換資料庫種類的時候，會有很高的機率遇到編譯失敗的窘境。</p>
</blockquote>
<p>若您的專案也經常使用手寫字串組織 SQL 指令，請不要花時間研究如何使用 SQLite 當作測試環境的資料庫了！</p>
<h3 id="利用-DB-交易機制避免副作用"><a href="#利用-DB-交易機制避免副作用" class="headerlink" title="利用 DB 交易機制避免副作用"></a>利用 DB 交易機制避免副作用</h3><p>SQLite In Memory 的方式失敗了，只好找用第二方案：資料庫交易處理機制（Transaction），在測試案例中加入交易機制，測試一結束就執行滾回（Rollback）。為了引入交易機制，建立一個客製化的類別，並繼承 TestCase 類別來銜接 CI3 內建的 DB 交易邏輯，如此一來測試環境的行為就不會對資料庫造成影響了：</p>
<figure class="highlight php hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * 功能三：將目前帳號加入至設備可切換帳號</span></span><br><span class="line"><span class="hljs-comment"> * 1. 將帳號加至 DB 中，where token = Cookie.token</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test_add_switchable_account</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function"></span>&#123;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;trans_begin();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">// @given admin 帳號</span></span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;init_switcher(<span class="hljs-keyword">self</span>::COOKIE_STATE);</span><br><span class="line">    $account = <span class="hljs-string">'admin'</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// @when 將 admin 帳號加入至設備可切換帳號</span></span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;switcher-&gt;add_switchable_account($account);</span><br><span class="line">    </span><br><span class="line">    <span class="hljs-comment">// @then 帳號 admin 已存至設備可切換帳號 DB 中</span></span><br><span class="line">    $switchable_account = <span class="hljs-keyword">$this</span>-&gt;get_switchable_account_from_db(<span class="hljs-keyword">$this</span>-&gt;state-&gt;token);</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;assertEquals(json_encode([$account]), $switchable_account[<span class="hljs-string">'switchable_account'</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;trans_rollback();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>當然，<strong>這個方案不夠好，要是資料庫裡面沒有我需要的測試資料呢？更何況單元測試本來就不應該依賴外部環境</strong>（如資料庫）不是嗎？因此後來我嘗試了好幾種建立測試資料的方案，例如 Seeds 或 Faker 等等…。但是公司專案的資料其實非常難建立，若為了測試環境而花費大把時間維護 Seeds 或 Faker 似乎也不是一個好辦法。最後終於在《<a href="https://www.tenlong.com.tw/products/9789862019481" target="_blank" rel="noopener">Specification By Example</a>》這本書找到最佳解決方案！</p>
<h3 id="拷貝「具有象徵性的真實資料」當作測試資料"><a href="#拷貝「具有象徵性的真實資料」當作測試資料" class="headerlink" title="拷貝「具有象徵性的真實資料」當作測試資料"></a>拷貝「具有象徵性的真實資料」當作測試資料</h3><p>《<a href="https://www.tenlong.com.tw/products/9789862019481" target="_blank" rel="noopener">Specification By Example</a>》中提及，若專案的較難建立就可以拷貝「具有象徵性的真實資料」，並且把被拷貝的資料存放在某個檔案中，進行測試的時候再將這些檔案轉譯成測試資料。這個方法讓我不再煩惱如何建立測試資料，現在只需要透過 PHP 的 <code>var_export()</code> 或 <code>json_encode()</code> 就可以將需要多道程序才能建立的資料拷貝起來，然後將拷貝的資料放在專門提供單元測試資料的類別(Test Data Provider)，供測試案例使用：</p>
<figure class="highlight php hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment"> * feat: 表單填寫頁面，選擇題允許輸入文字時，必填時也要檢查輸入文字 input</span></span><br><span class="line"><span class="hljs-comment"> */</span></span><br><span class="line"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">test_check_form_with_options_that_text_writable</span><span class="hljs-params">()</span></span></span><br><span class="line"><span class="hljs-function"></span>&#123;</span><br><span class="line">    <span class="hljs-keyword">$this</span>-&gt;describe(<span class="hljs-string">'必填「多選題」允許輸入文字，當沒有填寫 **所有已挑選選項** 的文字時，不可通過必填檢查'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>&#123;</span><br><span class="line">        <span class="hljs-comment">// @given 必填「多選題」允許輸入文字</span></span><br><span class="line">        <span class="hljs-comment">// @given 沒有填寫所有已挑選的選項之文字方塊</span></span><br><span class="line">        $data_provider = <span class="hljs-keyword">new</span> Test_data_provider();</span><br><span class="line">        <span class="hljs-keyword">list</span>($question_block, $input, $ai_id, $role_id) = $data_provider-&gt;form_with_checkbox_that_text_writable_and_not_filled_all_text();</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">// @when 進行表單必填檢查</span></span><br><span class="line">        $answer_checker = <span class="hljs-keyword">new</span> Answer_checker();</span><br><span class="line">        $required_notice = $answer_checker-&gt;check_form($ai_id, $question_block, $input, $role_id);</span><br><span class="line"></span><br><span class="line">        <span class="hljs-comment">// @then 不通過表單必填檢查</span></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;assertEquals(<span class="hljs-number">1</span>, count($required_notice));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="替-Bug-撰寫測試案例"><a href="#替-Bug-撰寫測試案例" class="headerlink" title="替 Bug 撰寫測試案例"></a>替 Bug 撰寫測試案例</h3><p>值得一提的是，拷貝資料的做法除了提供 TDD 或 BDD 測試資料以外，也可以應用在 Debug。每當遇到 Bug 時，就可以把具有「Bug 特徵的輸入值」Copy 起來，並且為這個測試資料建立一個 <strong>Bug fix 測試案例</strong>。</p>
<p>接著我們要修正程式碼讓 Bug fix 的測試案例通過。當測試案例通過的時候，表示我們把 Bug 修正了。<strong>之後遇到新的問題的時候，不但要通過新的 Bug fix 測試案例，也需要通過所有「舊的 Bug fix 測試案例」</strong>，才能確保新的 Bug fix 不會破壞原本正常運作的邏輯！</p>
<hr>
<p>　　</p>
<h2 id="提出系統重構流程"><a href="#提出系統重構流程" class="headerlink" title="提出系統重構流程"></a>提出系統重構流程</h2><p>“導入系統重構”是技術顧問在面試中拜託我要幫忙的事項。</p>
<p>由於公司早期的開發人員沒有重構的習慣，所以平常有非常大量的技術債可以讓我進行重構，小至意義不明的變數名稱，大至超多層巢狀 if、foreach，有時候看到巨獸等級的義大利麵還會被嚇到心頭揪一下呢！</p>
<p>雖然平常我都會隨手進行重構一下 issue 會觸及的程式碼，但是一個團隊中只有一個人進行重構，對多年累積下來的 <strong>技術債</strong> 來說是不痛不癢的。所以我開始在公司內部的 Wiki 分享重構的知識；觀察專案中的核心功能有哪些；制定重構的 SOP 流程。最後將這些資訊整理一份簡易的簡報，用來跟主管和技術顧問討論要怎麼讓重構落地：</p>
<ul>
<li><a href="/blog/images/refactoring_proposal.pdf">系統重構流程.pdf</a></li>
</ul>
<h3 id="簡報大綱"><a href="#簡報大綱" class="headerlink" title="簡報大綱"></a>簡報大綱</h3><p>指出系統現有的問題：</p>
<ol>
<li>專案使用的 MVC 框架在面對數量龐大的模組和多變的需求下，容易變得耦合與臃腫。</li>
<li>專案中充滿著重複的程式碼邏輯，開發人員難以學習系統。</li>
</ol>
<p>提出的解決方案：</p>
<ol>
<li>導入領域模型層，讓程式碼抽象化，降低開發人員學習系統的難度，以及更容易應變變化。</li>
<li>導入 Wiki 文件系統，讓開發人員共同維護文件。</li>
</ol>
<p>也提供實際操作範例：</p>
<ol>
<li>如何撰寫整合測試案例，供重構時回歸測試用。</li>
<li>如何利用重構建立領域模型。</li>
<li>如何撰寫領域模型的單元測試。</li>
</ol>
<p>這份簡報的原意只是想用來討論 SOP，不過技術顧問看完後就開始調動人員準備執行了！</p>
<h2 id="持續重構，利用設計模式”擁抱變化“"><a href="#持續重構，利用設計模式”擁抱變化“" class="headerlink" title="持續重構，利用設計模式”擁抱變化“"></a>持續重構，利用設計模式”擁抱變化“</h2><h3 id="基本型別偏執-Primitive-Obsession"><a href="#基本型別偏執-Primitive-Obsession" class="headerlink" title="基本型別偏執(Primitive Obsession)"></a>基本型別偏執(Primitive Obsession)</h3><p>手頭上的專案每次遇到要匯出 Excel 的需求都會很頭痛，因為必須透過大量且複雜的 Array 來建立匯出資料。這是 <a href="https://www.kancloud.cn/sstd521/refactor/194265" target="_blank" rel="noopener">Primitive Obsession</a>（基本型別偏執）的壞味道，大量使用基本型別（如 Array）來組織一個有意義的結構。但是大量的基本型別閱讀起來跟大泥團沒什麼兩樣，因此做了 Replace Array with Object 重構：</p>
<p><img src="/blog/images/pasted-23.png" alt="引入物件，簡化建立 Excel 資料複雜度"></p>
<p>這次重構簡直是一勞永逸，之後遇到匯出 Excel 都是小菜一碟！其他開發人員也用得開心^^。</p>
<h3 id="Flyweight-享元模式"><a href="#Flyweight-享元模式" class="headerlink" title="Flyweight 享元模式"></a>Flyweight 享元模式</h3><p>在 Excel 解決了 <strong>基本型別偏執</strong> 臭味道後，又引入了新的問題：記憶體耗盡（memory exhausted）。為什麼會發生記憶體耗盡呢？因為對 Excel 物件來說，一欄一列都需要產生一個 Row 或 Cell 物件來乘載資料。一旦要匯出資料量很大，就有可能發生記憶體耗盡的問題：</p>
<p><img src="/blog/images/pasted-24.png" alt="建立太多 Row 與 Cell 物件造成記憶體耗盡"></p>
<p>為了避免記憶體耗盡的問題，導入了享元模式。享元模式的核心思想其實就是建立快取(Cache)。所有要匯出的資料只需通過快取的 Row 或 Cell 物件來渲染資料即可，不必再為每個 Row 與 Cell 建立獨立的物件。</p>
<figure class="highlight php hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Excel</span></span></span><br><span class="line"><span class="hljs-class"></span>&#123;</span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * Excel Row 物件</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * 使用享元模式，避免 new 太多列物件</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@var</span> Row $row</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-keyword">private</span> $row;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 新增一列</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> Cell|string|array $cells 欄位內容（可複數）</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> array $styles</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addRow</span><span class="hljs-params">(array $cells, $styles = array<span class="hljs-params">()</span>)</span></span></span><br><span class="line"><span class="hljs-function">    </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;flyweightRow();</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;row-&gt;clearCells();</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">foreach</span> ($cells <span class="hljs-keyword">as</span> $cell) &#123;</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;row-&gt;addCell($cell, $styles);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">$this</span>-&gt;stack(<span class="hljs-keyword">$this</span>-&gt;row);</span><br><span class="line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-comment">/**</span></span><br><span class="line"><span class="hljs-comment">     * 建立享元 Row 物件</span></span><br><span class="line"><span class="hljs-comment">     *</span></span><br><span class="line"><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> Row;</span></span><br><span class="line"><span class="hljs-comment">     */</span></span><br><span class="line">    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flyweightRow</span><span class="hljs-params">()</span>: <span class="hljs-title">void</span></span></span><br><span class="line"><span class="hljs-function">    </span>&#123;</span><br><span class="line">        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">$this</span>-&gt;row) &#123;</span><br><span class="line">            <span class="hljs-keyword">$this</span>-&gt;row = <span class="hljs-keyword">new</span> Row();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>加入快取機制後，即使要建立一個上萬筆資料的 Excel 活頁，也只需要一個 Row 與 Cell 物件就好了！</p>
<p><img src="/blog/images/pasted-25.png" alt="引入享元模式後，建立一個 Excel 活頁只需要一個 Row 與 Cell 物件即可。"></p>
<p>（雖然後來發現其實是迴圈邏輯寫錯才造成記憶體耗盡，但享元模式仍被保留下來了。）</p>
<h3 id="State-狀態模式"><a href="#State-狀態模式" class="headerlink" title="State 狀態模式"></a>State 狀態模式</h3><p>使用者希望系統提供「切換帳號功能」，讓使用者不必登出重打帳號密碼即可切換同一設備上曾經登入過的帳號，。</p>
<p>原先的設計是建立一個 <code>Switcher</code> 類別，讓每個設備產生獨立的 Token 並儲存在 Cookie 裡面，系統再由 Cookie 的 Token 撈取設備曾經登入過哪些帳號。</p>
<p>但是過沒多久，另一個客戶希望可以藉由 user_id 從舊系統的人事資料庫撈取多個可切換的帳號，但這個切換帳號的需求較適合用 Session 來實現。</p>
<p>為了讓系統可以同時使用 Cookie 與 Session 來切換帳號，我在 <code>Switcher</code> 類別中引入 <code>Switchable_state</code> 介面，並把原本 Cookie 的邏輯全部搬移至新類別 <code>Cookie_storage</code>：</p>
<p><img src="/blog/images/pasted-27.png" alt="重構 Switcher 類別，引入 Switchable_state 介面以便操作多種資料來源的需求。"></p>
<p>現在 <code>Switcher</code> 是透過 <code>Switchable_state</code> 介面來存取資料來源，因此我只需新增一個實作 <code>Switchable_state</code> 介面的類別來實現 Session 版本的切換帳號功能，即可無縫接軌地讓系統多出 Session 切換帳號功能。</p>
<p><img src="/blog/images/pasted-28.png" alt="系統可以同時保有 Cookie 與 Session 版本的切換帳號功能"></p>
<h3 id="Pipeline-流水線模式"><a href="#Pipeline-流水線模式" class="headerlink" title="Pipeline 流水線模式"></a>Pipeline 流水線模式</h3><p>系統有個每日信件功能，該功能會在每日凌晨啟動排程寄送當日的系統信件給使用者。<br>最初的需求為：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1. 寄送每日系統通知</span><br></pre></td></tr></table></figure>

<p>沒多久後，每日信件又有新的需求，要寄送新的信件種類：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 寄送每日「系統通知」</span><br><span class="line">2. 寄送每日「站內訊息」</span><br></pre></td></tr></table></figure>

<p>沒意外！每日信件馬上又出現第三個需求：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 寄送每日「系統通知」</span><br><span class="line">2. 寄送每日「站內訊息」</span><br><span class="line">3. 寄送「明日上課資訊」給教師</span><br></pre></td></tr></table></figure>

<p>每日信件功能原本的設計是，將所有建立信件內容的邏輯寫在同一個 Controller 上。但是隨著需求不斷增加，Controller 變得又龐大又複雜。</p>
<p>後來考量將來可能會需要寄送多種資訊給使用者，故重構程式結構，讓未來擴充每日信件功能比較方便：</p>
<ol>
<li>引入 Pipeline，把取得各種系統資訊的邏輯注入進 Pipeline。</li>
<li>透過 Pipeline 取得每日通知信件內容，並建立信件 HTML。</li>
<li>把建立「系統通知」信件邏輯搬移至 System_notify_handler.php</li>
<li>把建立「站內訊息」信件邏輯搬移至 Message_handler.php</li>
<li>把建立「開課資訊」信件邏輯搬移至 Course_start_handler.php</li>
</ol>
<p><img src="/blog/images/pasted-29.png" alt="重構後的結構"></p>
<p><img src="/blog/images/pasted-30.png" alt="每日信件功能只需透過新增 Pipeline 的任務，即可新增信件種類"></p>
<hr>
<p>　　</p>
<h2 id="導入-Event-Sourcing-概念紀錄系統日誌"><a href="#導入-Event-Sourcing-概念紀錄系統日誌" class="headerlink" title="導入 Event Sourcing 概念紀錄系統日誌"></a>導入 Event Sourcing 概念紀錄系統日誌</h2><h1 id="其他經驗"><a href="#其他經驗" class="headerlink" title="其他經驗"></a>其他經驗</h1><h2 id="高雄科技大學講授-PHP-程式設計課程"><a href="#高雄科技大學講授-PHP-程式設計課程" class="headerlink" title="高雄科技大學講授 PHP 程式設計課程"></a>高雄科技大學講授 PHP 程式設計課程</h2><p>技術顧問對 1 月份提出的 <strong>系統重構流程</strong> 相當有興趣，故將重構計畫整合至校外課堂中，帶領一批學生一起參與重構計畫，希望透過讓學生閱讀企業級的程式碼，栽培學生寫出「成熟」的程式。在這個計畫中，公司由經理和我每個禮拜中抽出兩天的時間到高雄科技大學替學生上課，上課的主題是網站系統開發，包含：</p>
<ul>
<li>Gitlab 基本操作  <ul>
<li>Commit</li>
<li>Commit Message 規範</li>
<li>Push</li>
<li>Pull</li>
<li>Merge Request 概念與用意</li>
</ul>
</li>
<li>HTML5</li>
<li>CSS</li>
<li>JavaScript</li>
<li>PHP</li>
<li>CodeIgniter 3</li>
<li>如何閱讀程式碼</li>
</ul>
<h3 id="翻轉教室"><a href="#翻轉教室" class="headerlink" title="翻轉教室"></a>翻轉教室</h3><p>每週兩天的上課時間，對網站開發沒概念的學生來說實在是太少了，因此必須設計一套適合的課程來解決時間太少的問題。最後遵循一套名為「翻轉教室」的教學方式，設計出讓學生在非上課時間也能夠自主學習的課程。</p>
<p><img src="/blog/images/pasted-19.png" alt="安排目標與練習，讓學生主動找時間學習"></p>
<p>翻轉教育的課程必須事先幫學生定製一系列的主題與範圍（如 HTML、JavaScript)，再給予每個主題的學習資源，讓學生以概括的方式快速了解主題。最後每個主搭配一些題目或情境，讓學生以解決問題導向的方式進行學習。另外，為了因應學生素質不一致的問題，教學資源和題目包含淺至深的議題，讓進度較快的學生不必等其他同學的進度，就能持續往下練習。</p>
<p>開始上課前幾週，只需要幫學生起個頭，簡介一下主題的內容與主題之間的關聯，並且指派每週作業。下課後學生就會自行找出實踐作業的相關知識，從中學習知識並且得到解決問題的成就感。</p>
<p>當學生熟悉翻轉教室的形式後，每次到學校上課都是與學生探討在作業中遇到常見錯誤、困難，並且提出良好的解決方案或學習方向。</p>
<h3 id="Gitlab-當作回饋機制"><a href="#Gitlab-當作回饋機制" class="headerlink" title="Gitlab 當作回饋機制"></a>Gitlab 當作回饋機制</h3><p><strong>翻轉教室主要是讓學生透過自主學習的方式進行學習，因此必須有個回饋機制讓學生知道自己學得正不正確</strong>。原本翻轉教室是利用每次上課時間，讓學生分享作業；以及講師帶領學生探討寫作業過程中遇到的問題來當作回饋。</p>
<p>我和經理選擇導入更適合開發人員的 Gitlab 來實踐回饋機制：</p>
<ul>
<li>利用 Milestone 要求學生將作業繳交至 Gitlab。</li>
<li>issue 功能則像 StackOverflow，讓學生可以公開討論自己的問題，個性羞怯的學生也能在 Gitlab 與講師或同學進行交流。</li>
<li>Merge Request 機制用來審視學生的作業，將學生做得不好的地方與建議即時回饋給學生。</li>
</ul>
<h3 id="利用-Merge-Request-導入良好的開發觀念"><a href="#利用-Merge-Request-導入良好的開發觀念" class="headerlink" title="利用 Merge Request 導入良好的開發觀念"></a>利用 Merge Request 導入良好的開發觀念</h3><p>Merge Request 讓我變成學生的個人教練，學生上傳程式碼後會立刻得到錯誤報告與改善建議。發現常見問題時，也可以 tag 所有學生一起討論並學習解決方案。</p>
<p>我和經理在 Merge Request 階段進行嚴謹的 Code Review，審查內容包含 Commit Message 規範、統一 Coding Style、重構和 Clean Code 觀念 …等，只要不合格就退回並給予改善建議。前幾個作業中，學生都被多次退回才通過 Code Review。</p>
<p>不到一個月，學生的程式碼變得相當成熟，不再有意義不明的變數名稱，也不會寫出巢狀 if，並且有能力釐清程式碼的職責。甚至能力較好的學生還會回頭重構前幾次的作業呢！</p>
<p>Code Review 除了訓練學生效果很好以外，我認為一個 IT 公司也應該好好利用 Code Review 持續培養開發人員良好的開發習慣與思維！</p>
<hr>

        </div>
        
        
        
    </div>
</div>





<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/blog/solid_ocp_definition_and_practices/">
                <span class="level-item">物件導向設計原則：開放封閉原則，定義、解析與實踐</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>


</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left is-sticky">
    
        

    <div class="card widget" id="toc">
        <div class="card-content">
            <div class="menu">
                <h3 class="menu-label">
                    文章目錄
                </h3>
                <ul class="menu-list"><li>
        <a class="is-flex" href="#2019-回顧前言">
        <span class="has-mr-6">1</span>
        <span>2019 回顧前言</span>
        </a></li><li>
        <a class="is-flex" href="#自學主題">
        <span class="has-mr-6">2</span>
        <span>自學主題</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#DDD《領域驅動設計》">
        <span class="has-mr-6">2.1</span>
        <span>DDD《領域驅動設計》</span>
        </a></li><li>
        <a class="is-flex" href="#《Clean-Architecture》">
        <span class="has-mr-6">2.2</span>
        <span>《Clean Architecture》</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#開發人員必須防止程式碼腐敗">
        <span class="has-mr-6">2.2.1</span>
        <span>開發人員必須防止程式碼腐敗</span>
        </a></li><li>
        <a class="is-flex" href="#隔離策略與機制，防止程式碼腐敗">
        <span class="has-mr-6">2.2.2</span>
        <span>隔離策略與機制，防止程式碼腐敗</span>
        </a></li><li>
        <a class="is-flex" href="#一直都是開放封閉原則">
        <span class="has-mr-6">2.2.3</span>
        <span>一直都是開放封閉原則</span>
        </a></li></ul></li></ul></li><li>
        <a class="is-flex" href="#工作實踐經驗">
        <span class="has-mr-6">3</span>
        <span>工作實踐經驗</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#替專案導入-Commit-Message-規範">
        <span class="has-mr-6">3.1</span>
        <span>替專案導入 Commit Message 規範</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#實際案例">
        <span class="has-mr-6">3.1.1</span>
        <span>實際案例</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#替專案導入單元測試">
        <span class="has-mr-6">3.2</span>
        <span>替專案導入單元測試</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#建立測試框架">
        <span class="has-mr-6">3.2.1</span>
        <span>建立測試框架</span>
        </a></li><li>
        <a class="is-flex" href="#隔離測試環境對-DB-的副作用">
        <span class="has-mr-6">3.2.2</span>
        <span>隔離測試環境對 DB 的副作用</span>
        </a></li><li>
        <a class="is-flex" href="#利用-DB-交易機制避免副作用">
        <span class="has-mr-6">3.2.3</span>
        <span>利用 DB 交易機制避免副作用</span>
        </a></li><li>
        <a class="is-flex" href="#拷貝「具有象徵性的真實資料」當作測試資料">
        <span class="has-mr-6">3.2.4</span>
        <span>拷貝「具有象徵性的真實資料」當作測試資料</span>
        </a></li><li>
        <a class="is-flex" href="#替-Bug-撰寫測試案例">
        <span class="has-mr-6">3.2.5</span>
        <span>替 Bug 撰寫測試案例</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#提出系統重構流程">
        <span class="has-mr-6">3.3</span>
        <span>提出系統重構流程</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#簡報大綱">
        <span class="has-mr-6">3.3.1</span>
        <span>簡報大綱</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#持續重構，利用設計模式”擁抱變化“">
        <span class="has-mr-6">3.4</span>
        <span>持續重構，利用設計模式”擁抱變化“</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#基本型別偏執-Primitive-Obsession">
        <span class="has-mr-6">3.4.1</span>
        <span>基本型別偏執(Primitive Obsession)</span>
        </a></li><li>
        <a class="is-flex" href="#Flyweight-享元模式">
        <span class="has-mr-6">3.4.2</span>
        <span>Flyweight 享元模式</span>
        </a></li><li>
        <a class="is-flex" href="#State-狀態模式">
        <span class="has-mr-6">3.4.3</span>
        <span>State 狀態模式</span>
        </a></li><li>
        <a class="is-flex" href="#Pipeline-流水線模式">
        <span class="has-mr-6">3.4.4</span>
        <span>Pipeline 流水線模式</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#導入-Event-Sourcing-概念紀錄系統日誌">
        <span class="has-mr-6">3.5</span>
        <span>導入 Event Sourcing 概念紀錄系統日誌</span>
        </a></li></ul></li><li>
        <a class="is-flex" href="#其他經驗">
        <span class="has-mr-6">4</span>
        <span>其他經驗</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#高雄科技大學講授-PHP-程式設計課程">
        <span class="has-mr-6">4.1</span>
        <span>高雄科技大學講授 PHP 程式設計課程</span>
        </a><ul class="menu-list"><li>
        <a class="is-flex" href="#翻轉教室">
        <span class="has-mr-6">4.1.1</span>
        <span>翻轉教室</span>
        </a></li><li>
        <a class="is-flex" href="#Gitlab-當作回饋機制">
        <span class="has-mr-6">4.1.2</span>
        <span>Gitlab 當作回饋機制</span>
        </a></li><li>
        <a class="is-flex" href="#利用-Merge-Request-導入良好的開發觀念">
        <span class="has-mr-6">4.1.3</span>
        <span>利用 Merge Request 導入良好的開發觀念</span>
        </a></li></ul></li></ul></li></ul>
            </div>
        </div>
    </div>

    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/blog/2019_review/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/blog/images/thumbnail/2019_reviews.png" alt="2019 回顧工作與學習歷程">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-12-19T06:48:16.000Z">2019-12-19</time></div>
                    <a href="/blog/2019_review/" class="title has-link-black-ter is-size-6 has-text-weight-normal">2019 回顧工作與學習歷程</a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/blog/solid_ocp_definition_and_practices/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/blog/images/thumbnail/CLEAN_CODE.jpg" alt="物件導向設計原則：開放封閉原則，定義、解析與實踐">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-12-09T06:11:00.000Z">2019-12-09</time></div>
                    <a href="/blog/solid_ocp_definition_and_practices/" class="title has-link-black-ter is-size-6 has-text-weight-normal">物件導向設計原則：開放封閉原則，定義、解析與實踐</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/blog/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC%E6%80%9D%E7%B6%AD/">軟體開發思維</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/blog/solid_srp_definition_and_practices/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/blog/images/thumbnail/CLEAN_CODE.jpg" alt="物件導向設計原則：單一職責原則，定義、解析與實踐">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-12-03T03:04:00.000Z">2019-12-03</time></div>
                    <a href="/blog/solid_srp_definition_and_practices/" class="title has-link-black-ter is-size-6 has-text-weight-normal">物件導向設計原則：單一職責原則，定義、解析與實踐</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/blog/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC%E6%80%9D%E7%B6%AD/">軟體開發思維</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/blog/cluelessness_in_self_learning/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/blog/images/thumbnail/SELF_TEACHING.jpg" alt="自學時應該看破“無緒”">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-22T03:09:00.000Z">2019-11-22</time></div>
                    <a href="/blog/cluelessness_in_self_learning/" class="title has-link-black-ter is-size-6 has-text-weight-normal">自學時應該看破“無緒”</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/blog/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC%E6%80%9D%E7%B6%AD/">軟體開發思維</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/blog/Cluelessness/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/blog/images/thumbnail/CLEAN_CODE.jpg" alt="軟體開發中的“無緒”">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-11-21T09:41:00.000Z">2019-11-21</time></div>
                    <a href="/blog/Cluelessness/" class="title has-link-black-ter is-size-6 has-text-weight-normal">軟體開發中的“無緒”</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/blog/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC%E6%80%9D%E7%B6%AD/">軟體開發思維</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分類
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/blog/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC%E6%80%9D%E7%B6%AD/">
            <span class="level-start">
                <span class="level-item">軟體開發思維</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">9</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/blog/categories/%E8%BB%9F%E9%AB%94%E9%96%8B%E7%99%BC%E6%80%9D%E7%B6%AD/%E9%87%8D%E6%A7%8B/">
            <span class="level-start">
                <span class="level-item">重構</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            彙整
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/12/">
                <span class="level-start">
                    <span class="level-item">十二月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">十月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/blog/archives/2018/10/">
                <span class="level-start">
                    <span class="level-item">十月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                標籤
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/Clean-Code/">
                        <span class="tag">Clean Code</span>
                        <span class="tag is-grey">7</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/SOLID-%E5%8E%9F%E5%89%87/">
                        <span class="tag">SOLID 原則</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/codeigiter3/">
                        <span class="tag">codeigiter3</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/php/">
                        <span class="tag">php</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/%E8%87%AA%E5%AD%B8%E6%8A%80%E5%B7%A7/">
                        <span class="tag">自學技巧</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/blog/tags/%E9%87%8D%E6%A7%8B/">
                        <span class="tag">重構</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/blog/">
                
                    <img src="/blog/images/mylogo.png" alt="2019 回顧工作與學習歷程" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 WadeHuangTW1993&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-TW");</script>

<script>
var IcarusThemeSettings = {
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>



    
    
<script src="/blog/js/animation.js"></script>

    
    
<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/blog/js/gallery.js" defer></script>

    
    
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" target="_blank" rel="noopener">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>

    
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>
    
    
<a id="back-to-top" title="回到頁首" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/blog/js/back-to-top.js" defer></script>

    
    
    
    
    
    
    
    
    
    
    


<script src="/blog/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="請輸入關鍵字..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '頁面',
                CATEGORIES: '分類',
                TAGS: '標籤',
                UNTITLED: '(無標題)',
            },
            CONTENT_URL: '/blog/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/blog/js/insight.js" defer></script>
<link rel="stylesheet" href="/blog/css/search.css">
<link rel="stylesheet" href="/blog/css/insight.css">
    

    <script src="/blog/js/hexo_resize_image.js"></script>
</body>
</html>